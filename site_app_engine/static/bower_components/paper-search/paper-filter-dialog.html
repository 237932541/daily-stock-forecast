<!DOCTYPE html><html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../app-layout/app-toolbar/app-toolbar.html"><link rel="import" href="../iron-icons/iron-icons.html"><link rel="import" href="../iron-flex-layout/iron-flex-layout.html"><link rel="import" href="../iron-list/iron-list.html"><link rel="import" href="../paper-button/paper-button.html"><link rel="import" href="../paper-dialog/paper-dialog.html"><link rel="import" href="../paper-icon-button/paper-icon-button.html"><link rel="import" href="../paper-item/paper-item.html"><link rel="import" href="../paper-item/paper-item-body.html"><link rel="import" href="../paper-styles/default-theme.html"><link rel="import" href="../paper-checkbox/paper-checkbox.html"></head><body><dom-module id="paper-filter-dialog"><template><style>.dialog{@apply --paper-filter-dialog;--paper-dialog-background-color:var(--paper-filter-dialog-background-color);}app-toolbar{@apply --paper-filter-toolbar;--app-toolbar-background:var(--paper-filter-toolbar-background);}paper-button{font-size:initial;}.dialog,.page{@apply --layout-fit;}.page{@apply --layout-vertical;margin:0;padding:0;}.list{@apply --layout-flex;}.filter{border-bottom:1px solid var(--divider-color);}.filter,.value{cursor:pointer;background:white;}.filter-body{height:1px;}.value-holder{@apply --layout-vertical;}.nrResults{color:var(--secondary-text-color);}</style><array-selector id="selector" items="{{filters}}" selected="{{_selectedFilter}}"></array-selector><paper-dialog id="dialog" class="dialog"><template is="dom-if" if="{{!_selectedFilter}}"><div class="page"><app-toolbar><paper-icon-button on-tap="close" icon="close"></paper-icon-button><span main-title=""></span><paper-button on-tap="_tapReset" class="reset" hidden$="[[!_hasSelectedFilters(_selectedFilters)]]">[[resetButton]]</paper-button><paper-button on-tap="_tapApply" dialog-confirm="">[[saveButton]]</paper-button></app-toolbar><iron-list items="[[filters]]" as="filter" class="list"><template><paper-item class="filter" on-tap="_tapSelectFilter"><paper-ripple fit=""></paper-ripple><paper-item-body two-line="" class="filter-body"><div class="name">[[filter.name]]</div><div secondary="">[[_getSelectedValuesNames(filter, _selectedFilters)]]</div></paper-item-body></paper-item></template></iron-list></div></template><template is="dom-if" if="{{_selectedFilter}}"><div class="page"><app-toolbar><paper-icon-button icon="arrow-back" on-tap="_tapSelectValues"></paper-icon-button><span main-title="">[[_selectedFilter.name]]</span></app-toolbar><iron-list id="valuesList" items="[[_selectedFilterValues]]" as="filterValue" class="list"><template><div class="value-holder"><paper-item class="value"><paper-checkbox name="[[filterValue.id]]" checked="{{filterValue.selected}}"></paper-checkbox><div>[[filterValue.name]] <span class="nrResults" hidden="[[!filterValue.count]]">([[filterValue.count]])</span></div></paper-item></div></template></iron-list></div></template></paper-dialog></template></dom-module><script>(function(){Polymer({is:'paper-filter-dialog',properties:{filters:Array,selectedFilters:{type:Object,notify:!0,value:{}},resetButton:{type:String,value:'Reset'},saveButton:{type:String,value:'Save filters'},noValuesLabel:{type:String,value:'No filters yet'},_selectedFilters:{type:Object,value:{}},_selectedFilter:Object,_selectedFilterValues:{type:Array,value:[]}},open:function(){Polymer.dom(document.body).appendChild(this),setTimeout(function(){this.$.dialog.open(),this._selectedFilters=Object.assign({},this.selectedFilters)}.bind(this),1)},close:function(){this.$.dialog.close()},_tapSelectFilter:function(a){this.$.selector.select(a.model.filter),this._preselectFilterValues()},_preselectFilterValues:function(){var a=this._selectedFilters[this._selectedFilter.id],b=function(b){return!!a&&0<=a.indexOf(b.id)};this._selectedFilterValues=this._selectedFilter.values.map(function(a){return Object.assign({},a,{selected:b(a)})})},_tapReset:function(){this._selectedFilters={}},_tapApply:function(){this.selectedFilters=this._selectedFilters,this.fire('save')},_tapSelectValues:function(){const a=this._selectedFilterValues.filter(function(a){return a.selected}).map(function(a){return a.id});this._selectedFilters=Object.assign({},this._selectedFilters,{[this._selectedFilter.id]:a}),this.$.selector.deselect(this._selectedFilter)},_hasSelectedFilters:function(a){for(selectedFilter in a)if(0<a[selectedFilter].length)return!0;return!1},_getSelectedValuesNames:function(a,b){var c=b[a.id];if(!a.values||!c)return this.noValuesLabel;var d=a.values.filter(function(a){return 0<=c.indexOf(a.id)}).map(function(a){return a.name});return 0<d.length?d.join(', '):this.noValuesLabel}})})();</script></body></html>